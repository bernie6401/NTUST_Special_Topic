
  0%|                                                                                        | 0/50 [00:00<?, ?it/s]
Loading pretrained weights... ../models/GEMEP_old/epoch13_acc0.999.pth
The dataset is GEMEP and the path is ../datasets/GEMEP/
Train set size: 5740
Validation set size: 1319
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0001
)
[Epoch 1] Training accuracy: 0.9871. Loss: 0.042 LR: 0.001000

  2%|█▌                                                                              | 1/50 [00:27<22:50, 27.96s/it]
[Epoch 1] Validation accuracy:0.3427. Loss:4.249
Val correct sum 452 and length is 1319
Model saved.
best_acc:0.3427
[Epoch 2] Training accuracy: 0.9915. Loss: 0.026 LR: 0.001000
Training correct sum 5691 and length is 5740
[Epoch 2] Validation accuracy:0.3783. Loss:5.316
Val correct sum 499 and length is 1319
Model saved.

  4%|███▏                                                                            | 2/50 [00:54<21:48, 27.25s/it]
[Epoch 3] Training accuracy: 0.9897. Loss: 0.035 LR: 0.001000

  6%|████▊                                                                           | 3/50 [01:21<21:11, 27.04s/it]
[Epoch 3] Validation accuracy:0.4071. Loss:4.251
Val correct sum 537 and length is 1319
Model saved.
best_acc:0.4071
[Epoch 4] Training accuracy: 0.9899. Loss: 0.031 LR: 0.001000
Training correct sum 5682 and length is 5740
[Epoch 4] Validation accuracy:0.3647. Loss:6.100

  8%|██████▍                                                                         | 4/50 [01:47<20:33, 26.82s/it]
[Epoch 5] Training accuracy: 0.9936. Loss: 0.022 LR: 0.001000

 10%|████████                                                                        | 5/50 [02:14<20:01, 26.69s/it]
[Epoch 5] Validation accuracy:0.3472. Loss:5.419
Val correct sum 458 and length is 1319
[Epoch 6] Training accuracy: 0.9936. Loss: 0.028 LR: 0.001000
Training correct sum 5703 and length is 5740
[Epoch 6] Validation accuracy:0.3518. Loss:4.761

 12%|█████████▌                                                                      | 6/50 [02:41<19:42, 26.88s/it]
[Epoch 7] Training accuracy: 0.9948. Loss: 0.016 LR: 0.001000
Training correct sum 5710 and length is 5740
[Epoch 7] Validation accuracy:0.3199. Loss:6.096

 14%|███████████▏                                                                    | 7/50 [03:08<19:12, 26.80s/it]
[Epoch 8] Training accuracy: 0.9915. Loss: 0.026 LR: 0.001000
Training correct sum 5691 and length is 5740
[Epoch 8] Validation accuracy:0.3798. Loss:6.832

 16%|████████████▊                                                                   | 8/50 [03:35<18:45, 26.80s/it]
[Epoch 9] Training accuracy: 0.9927. Loss: 0.027 LR: 0.001000
Training correct sum 5698 and length is 5740
[Epoch 9] Validation accuracy:0.4306. Loss:7.435
Val correct sum 568 and length is 1319
Model saved.

 18%|██████████████▍                                                                 | 9/50 [04:01<18:17, 26.76s/it]
[Epoch 10] Training accuracy: 0.9981. Loss: 0.007 LR: 0.001000
Training correct sum 5729 and length is 5740
[Epoch 10] Validation accuracy:0.3518. Loss:4.861

 20%|███████████████▊                                                               | 10/50 [04:28<17:50, 26.76s/it]
[Epoch 11] Training accuracy: 0.3214. Loss: 2.088 LR: 0.040000
Training correct sum 1845 and length is 5740
[Epoch 11] Validation accuracy:0.3609. Loss:1.704

 22%|█████████████████▍                                                             | 11/50 [04:55<17:24, 26.78s/it]
[Epoch 12] Training accuracy: 0.3624. Loss: 1.687 LR: 0.040000
Training correct sum 2080 and length is 5740
[Epoch 12] Validation accuracy:0.3609. Loss:1.695

 24%|██████████████████▉                                                            | 12/50 [05:22<16:59, 26.84s/it]
[Epoch 13] Training accuracy: 0.3624. Loss: 1.684 LR: 0.040000
Training correct sum 2080 and length is 5740
[Epoch 13] Validation accuracy:0.3609. Loss:1.693

 26%|████████████████████▌                                                          | 13/50 [05:49<16:33, 26.85s/it]
[Epoch 14] Training accuracy: 0.3624. Loss: 1.686 LR: 0.040000
Training correct sum 2080 and length is 5740
[Epoch 14] Validation accuracy:0.3609. Loss:1.700

 28%|██████████████████████                                                         | 14/50 [06:15<16:03, 26.77s/it]
[Epoch 15] Training accuracy: 0.3624. Loss: 1.685 LR: 0.040000
Training correct sum 2080 and length is 5740
[Epoch 15] Validation accuracy:0.3609. Loss:1.700

 30%|███████████████████████▋                                                       | 15/50 [06:42<15:38, 26.81s/it]
[Epoch 16] Training accuracy: 0.3624. Loss: 1.686 LR: 0.040000
Training correct sum 2080 and length is 5740
[Epoch 16] Validation accuracy:0.3609. Loss:1.700

 32%|█████████████████████████▎                                                     | 16/50 [07:09<15:10, 26.78s/it]
[Epoch 17] Training accuracy: 0.3624. Loss: 1.685 LR: 0.040000
Training correct sum 2080 and length is 5740
[Epoch 17] Validation accuracy:0.3609. Loss:1.694

 34%|██████████████████████████▊                                                    | 17/50 [07:35<14:40, 26.68s/it]
[Epoch 18] Training accuracy: 0.3624. Loss: 1.685 LR: 0.040000
Training correct sum 2080 and length is 5740
[Epoch 18] Validation accuracy:0.3609. Loss:1.693

 36%|████████████████████████████▍                                                  | 18/50 [08:02<14:16, 26.76s/it]
[Epoch 19] Training accuracy: 0.3624. Loss: 1.684 LR: 0.040000
Training correct sum 2080 and length is 5740
[Epoch 19] Validation accuracy:0.3609. Loss:1.696

 38%|██████████████████████████████                                                 | 19/50 [08:29<13:46, 26.66s/it]
[Epoch 20] Training accuracy: 0.3624. Loss: 1.683 LR: 0.040000
Training correct sum 2080 and length is 5740
[Epoch 20] Validation accuracy:0.3609. Loss:1.696

 40%|███████████████████████████████▌                                               | 20/50 [08:55<13:13, 26.44s/it]
[Epoch 21] Training accuracy: 0.1672. Loss: 2665.059 LR: 1.600000
Training correct sum 960 and length is 5740
[Epoch 21] Validation accuracy:0.0485. Loss:429.724

 42%|█████████████████████████████████▏                                             | 21/50 [09:20<12:38, 26.16s/it]
[Epoch 22] Training accuracy: 0.2331. Loss: 337.704 LR: 1.600000
Training correct sum 1338 and length is 5740
[Epoch 22] Validation accuracy:0.1766. Loss:47.214

 44%|██████████████████████████████████▊                                            | 22/50 [09:46<12:07, 26.00s/it]
[Epoch 23] Training accuracy: 0.2362. Loss: 34.046 LR: 1.600000
Training correct sum 1356 and length is 5740
[Epoch 23] Validation accuracy:0.3609. Loss:18.775

 46%|████████████████████████████████████▎                                          | 23/50 [10:12<11:40, 25.96s/it]
[Epoch 24] Training accuracy: 0.2636. Loss: 27.546 LR: 1.600000
Training correct sum 1513 and length is 5740
[Epoch 24] Validation accuracy:0.1365. Loss:14.800

 48%|█████████████████████████████████████▉                                         | 24/50 [10:37<11:11, 25.84s/it]
[Epoch 25] Training accuracy: 0.2510. Loss: 11.678 LR: 1.600000
Training correct sum 1441 and length is 5740
[Epoch 25] Validation accuracy:0.1766. Loss:11.003

 50%|███████████████████████████████████████▌                                       | 25/50 [11:03<10:45, 25.83s/it]
[Epoch 26] Training accuracy: 0.2334. Loss: 10.314 LR: 1.600000

 52%|█████████████████████████████████████████                                      | 26/50 [11:29<10:20, 25.84s/it]
[Epoch 26] Validation accuracy:0.1365. Loss:7.754
Val correct sum 180 and length is 1319
[Epoch 27] Training accuracy: 0.2371. Loss: 5.343 LR: 1.600000
Training correct sum 1361 and length is 5740
[Epoch 27] Validation accuracy:0.3609. Loss:7.133

 54%|██████████████████████████████████████████▋                                    | 27/50 [11:54<09:50, 25.67s/it]
[Epoch 28] Training accuracy: 0.2610. Loss: 3.891 LR: 1.600000
Training correct sum 1498 and length is 5740
[Epoch 28] Validation accuracy:0.3609. Loss:2.283

 56%|████████████████████████████████████████████▏                                  | 28/50 [12:19<09:21, 25.52s/it]
[Epoch 29] Training accuracy: 0.3418. Loss: 1.777 LR: 1.600000
Training correct sum 1962 and length is 5740
[Epoch 29] Validation accuracy:0.3609. Loss:1.753

 58%|█████████████████████████████████████████████▊                                 | 29/50 [12:45<08:57, 25.59s/it]
[Epoch 30] Training accuracy: 0.3624. Loss: 1.714 LR: 1.600000
Training correct sum 2080 and length is 5740
[Epoch 30] Validation accuracy:0.3609. Loss:1.773

 60%|███████████████████████████████████████████████▍                               | 30/50 [13:11<08:30, 25.54s/it]
[Epoch 31] Training accuracy: 0.1666. Loss: 1057924544.000 LR: 64.000000
Training correct sum 956 and length is 5740
[Epoch 31] Validation accuracy:0.1820. Loss:27620396.000

 62%|████████████████████████████████████████████████▉                              | 31/50 [13:36<08:04, 25.49s/it]
[Epoch 32] Training accuracy: 0.1843. Loss: 15894578.000 LR: 64.000000
Training correct sum 1058 and length is 5740
[Epoch 32] Validation accuracy:0.1766. Loss:6391980.500

 64%|██████████████████████████████████████████████████▌                            | 32/50 [14:02<07:39, 25.52s/it]
[Epoch 33] Training accuracy: 0.1737. Loss: 882366.875 LR: 64.000000
Training correct sum 997 and length is 5740
[Epoch 33] Validation accuracy:0.0371. Loss:45498.262

 66%|████████████████████████████████████████████████████▏                          | 33/50 [14:27<07:12, 25.47s/it]
[Epoch 34] Training accuracy: 0.1943. Loss: 80913.438 LR: 64.000000
Training correct sum 1115 and length is 5740
[Epoch 34] Validation accuracy:0.3609. Loss:376238.969

 68%|█████████████████████████████████████████████████████▋                         | 34/50 [14:53<06:48, 25.56s/it]
[Epoch 35] Training accuracy: 0.2098. Loss: 45757.922 LR: 64.000000
Training correct sum 1204 and length is 5740
[Epoch 35] Validation accuracy:0.3609. Loss:173376.719

 70%|███████████████████████████████████████████████████████▎                       | 35/50 [15:18<06:22, 25.47s/it]
[Epoch 36] Training accuracy: 0.1983. Loss: 19450.961 LR: 64.000000
Training correct sum 1138 and length is 5740
[Epoch 36] Validation accuracy:0.3609. Loss:20871.527

 72%|████████████████████████████████████████████████████████▉                      | 36/50 [15:44<05:57, 25.56s/it]
[Epoch 37] Training accuracy: 0.2057. Loss: 10416.529 LR: 64.000000
Training correct sum 1181 and length is 5740
[Epoch 37] Validation accuracy:0.3609. Loss:66245.859

 74%|██████████████████████████████████████████████████████████▍                    | 37/50 [16:09<05:31, 25.53s/it]
[Epoch 38] Training accuracy: 0.2042. Loss: 3547.688 LR: 64.000000
Training correct sum 1172 and length is 5740
[Epoch 38] Validation accuracy:0.1365. Loss:694199680.000

 76%|████████████████████████████████████████████████████████████                   | 38/50 [16:35<05:06, 25.52s/it]
[Epoch 39] Training accuracy: 0.2066. Loss: 4131.118 LR: 64.000000

 78%|█████████████████████████████████████████████████████████████▌                 | 39/50 [17:00<04:40, 25.52s/it]
[Epoch 39] Validation accuracy:0.3609. Loss:32939.020
Val correct sum 476 and length is 1319
[Epoch 40] Training accuracy: 0.1793. Loss: 3271.569 LR: 64.000000
Training correct sum 1029 and length is 5740
[Epoch 40] Validation accuracy:0.3609. Loss:30011.283

 80%|███████████████████████████████████████████████████████████████▏               | 40/50 [17:26<04:14, 25.48s/it]
[Epoch 41] Training accuracy: 0.1679. Loss: 23767680024576.000 LR: 2560.000000
Training correct sum 964 and length is 5740
[Epoch 41] Validation accuracy:0.1766. Loss:13203574620160.000

 82%|████████████████████████████████████████████████████████████████▊              | 41/50 [17:51<03:49, 25.51s/it]
[Epoch 42] Training accuracy: 0.1232. Loss: 1640549711872.000 LR: 2560.000000
Training correct sum 707 and length is 5740
[Epoch 42] Validation accuracy:0.3609. Loss:97503526912.000

 84%|██████████████████████████████████████████████████████████████████▎            | 42/50 [18:31<03:31, 26.47s/it]
Traceback (most recent call last):
  File "train_hfp.py", line 242, in <module>
    main()
  File "train_hfp.py", line 107, in main
    train(i, train_loader, len_train, model, CE_criterion, optimizer, scheduler)
  File "train_hfp.py", line 133, in train
    targets = targets.cuda()
KeyboardInterrupt